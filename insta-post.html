<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Post Static Image to Instagram</title>
  <style>
    body { font-family: sans-serif; max-width: 400px; margin: 2em auto; }
    textarea, button { width: 100%; margin-top: 0.5em; padding: 0.5em; }
    button { cursor: pointer; }
  </style>
</head>
<body>

  <h1>Instagram Poster (Static Image)</h1>
  <form id="igForm">
    <label>
      Caption:
      <textarea id="captionInput" placeholder="Write a caption…" rows="4"></textarea>
    </label>
    <button type="submit">Post to Instagram</button>
    <p id="status" style="color: #b00; margin-top:1em;"></p>
  </form>

  <script>
    (function(){
      const form = document.getElementById('igForm');
      const captionInput = document.getElementById('captionInput');
      const statusEl = document.getElementById('status');

      // Your static Base64 image data URI
      const STATIC_IMAGE_BASE64 = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBwgHBgkIBwgKCgkLDRYPDQwMDRsUFRAWIB0iIiAdHx8kKDQsJCYxJx8fLT0tMTU3Ojo6Iys/RD84QzQ5OjcBCgoKDQwNGg8PGjclHyU3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3N//AABEIAJQAxwMBEQACEQEDEQH/... (truncated for brevity)";

      form.addEventListener('submit', async e => {
        e.preventDefault();
        statusEl.textContent = '';

        const caption = captionInput.value.trim();

        try {
          const resp = await fetch('/api/instagram/post', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              imageData: STATIC_IMAGE_BASE64,
              caption: caption
            })
          });

          if (!resp.ok) {
            const err = await resp.json();
            throw new Error(err.error || resp.statusText);
          }

          const data = await resp.json();
          statusEl.style.color = 'green';
          statusEl.textContent = '✅ Posted! ID: ' + data.postId;
        } catch (err) {
          console.error(err);
          statusEl.style.color = '#b00';
          statusEl.textContent = '❌ Failed: ' + err.message;
        }
      });
    })();
  </script>

</body>
</html>
